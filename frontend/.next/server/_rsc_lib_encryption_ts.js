"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_encryption_ts";
exports.ids = ["_rsc_lib_encryption_ts"];
exports.modules = {

/***/ "(rsc)/./lib/encryption.ts":
/*!***************************!*\
  !*** ./lib/encryption.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decrypt: () => (/* binding */ decrypt),\n/* harmony export */   encrypt: () => (/* binding */ encrypt)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nconst ALGORITHM = \"aes-256-gcm\";\nconst IV_LENGTH = 12;\nconst AUTH_TAG_LENGTH = 16;\nconst SALT = \"claude-bot-salt-v1\";\nfunction encrypt(plaintext, encryptionKey) {\n    const key = crypto__WEBPACK_IMPORTED_MODULE_0___default().scryptSync(encryptionKey, SALT, 32);\n    const iv = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(IV_LENGTH);\n    const cipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createCipheriv(ALGORITHM, key, iv, {\n        authTagLength: AUTH_TAG_LENGTH\n    });\n    let encrypted = cipher.update(plaintext, \"utf8\", \"base64\");\n    encrypted += cipher.final(\"base64\");\n    const authTag = cipher.getAuthTag();\n    return {\n        encrypted,\n        iv: iv.toString(\"base64\"),\n        authTag: authTag.toString(\"base64\")\n    };\n}\nfunction decrypt(encrypted, iv, authTag, encryptionKey) {\n    const key = crypto__WEBPACK_IMPORTED_MODULE_0___default().scryptSync(encryptionKey, SALT, 32);\n    const decipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createDecipheriv(ALGORITHM, key, Buffer.from(iv, \"base64\"), {\n        authTagLength: AUTH_TAG_LENGTH\n    });\n    decipher.setAuthTag(Buffer.from(authTag, \"base64\"));\n    let decrypted = decipher.update(encrypted, \"base64\", \"utf8\");\n    decrypted += decipher.final(\"utf8\");\n    return decrypted;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZW5jcnlwdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRCO0FBRTVCLE1BQU1DLFlBQVk7QUFDbEIsTUFBTUMsWUFBWTtBQUNsQixNQUFNQyxrQkFBa0I7QUFDeEIsTUFBTUMsT0FBTztBQUVOLFNBQVNDLFFBQVFDLFNBQWlCLEVBQUVDLGFBQXFCO0lBQzlELE1BQU1DLE1BQU1SLHdEQUFpQixDQUFDTyxlQUFlSCxNQUFNO0lBQ25ELE1BQU1NLEtBQUtWLHlEQUFrQixDQUFDRTtJQUU5QixNQUFNVSxTQUFTWiw0REFBcUIsQ0FBQ0MsV0FBV08sS0FBS0UsSUFBSTtRQUN2REksZUFBZVg7SUFDakI7SUFFQSxJQUFJWSxZQUFZSCxPQUFPSSxNQUFNLENBQUNWLFdBQVcsUUFBUTtJQUNqRFMsYUFBYUgsT0FBT0ssS0FBSyxDQUFDO0lBRTFCLE1BQU1DLFVBQVVOLE9BQU9PLFVBQVU7SUFFakMsT0FBTztRQUNMSjtRQUNBTCxJQUFJQSxHQUFHVSxRQUFRLENBQUM7UUFDaEJGLFNBQVNBLFFBQVFFLFFBQVEsQ0FBQztJQUM1QjtBQUNGO0FBRU8sU0FBU0MsUUFDZE4sU0FBaUIsRUFDakJMLEVBQVUsRUFDVlEsT0FBZSxFQUNmWCxhQUFxQjtJQUVyQixNQUFNQyxNQUFNUix3REFBaUIsQ0FBQ08sZUFBZUgsTUFBTTtJQUVuRCxNQUFNa0IsV0FBV3RCLDhEQUF1QixDQUN0Q0MsV0FDQU8sS0FDQWdCLE9BQU9DLElBQUksQ0FBQ2YsSUFBSSxXQUNoQjtRQUFFSSxlQUFlWDtJQUFnQjtJQUduQ21CLFNBQVNJLFVBQVUsQ0FBQ0YsT0FBT0MsSUFBSSxDQUFDUCxTQUFTO0lBRXpDLElBQUlTLFlBQVlMLFNBQVNOLE1BQU0sQ0FBQ0QsV0FBVyxVQUFVO0lBQ3JEWSxhQUFhTCxTQUFTTCxLQUFLLENBQUM7SUFFNUIsT0FBT1U7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2NsYXVkZS1ib3Qtc2V0dXAvLi9saWIvZW5jcnlwdGlvbi50cz8zMzc1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuXG5jb25zdCBBTEdPUklUSE0gPSBcImFlcy0yNTYtZ2NtXCI7XG5jb25zdCBJVl9MRU5HVEggPSAxMjtcbmNvbnN0IEFVVEhfVEFHX0xFTkdUSCA9IDE2O1xuY29uc3QgU0FMVCA9IFwiY2xhdWRlLWJvdC1zYWx0LXYxXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmNyeXB0KHBsYWludGV4dDogc3RyaW5nLCBlbmNyeXB0aW9uS2V5OiBzdHJpbmcpIHtcbiAgY29uc3Qga2V5ID0gY3J5cHRvLnNjcnlwdFN5bmMoZW5jcnlwdGlvbktleSwgU0FMVCwgMzIpO1xuICBjb25zdCBpdiA9IGNyeXB0by5yYW5kb21CeXRlcyhJVl9MRU5HVEgpO1xuXG4gIGNvbnN0IGNpcGhlciA9IGNyeXB0by5jcmVhdGVDaXBoZXJpdihBTEdPUklUSE0sIGtleSwgaXYsIHtcbiAgICBhdXRoVGFnTGVuZ3RoOiBBVVRIX1RBR19MRU5HVEgsXG4gIH0pO1xuXG4gIGxldCBlbmNyeXB0ZWQgPSBjaXBoZXIudXBkYXRlKHBsYWludGV4dCwgXCJ1dGY4XCIsIFwiYmFzZTY0XCIpO1xuICBlbmNyeXB0ZWQgKz0gY2lwaGVyLmZpbmFsKFwiYmFzZTY0XCIpO1xuXG4gIGNvbnN0IGF1dGhUYWcgPSBjaXBoZXIuZ2V0QXV0aFRhZygpO1xuXG4gIHJldHVybiB7XG4gICAgZW5jcnlwdGVkLFxuICAgIGl2OiBpdi50b1N0cmluZyhcImJhc2U2NFwiKSxcbiAgICBhdXRoVGFnOiBhdXRoVGFnLnRvU3RyaW5nKFwiYmFzZTY0XCIpLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjcnlwdChcbiAgZW5jcnlwdGVkOiBzdHJpbmcsXG4gIGl2OiBzdHJpbmcsXG4gIGF1dGhUYWc6IHN0cmluZyxcbiAgZW5jcnlwdGlvbktleTogc3RyaW5nXG4pIHtcbiAgY29uc3Qga2V5ID0gY3J5cHRvLnNjcnlwdFN5bmMoZW5jcnlwdGlvbktleSwgU0FMVCwgMzIpO1xuXG4gIGNvbnN0IGRlY2lwaGVyID0gY3J5cHRvLmNyZWF0ZURlY2lwaGVyaXYoXG4gICAgQUxHT1JJVEhNLFxuICAgIGtleSxcbiAgICBCdWZmZXIuZnJvbShpdiwgXCJiYXNlNjRcIiksXG4gICAgeyBhdXRoVGFnTGVuZ3RoOiBBVVRIX1RBR19MRU5HVEggfVxuICApO1xuXG4gIGRlY2lwaGVyLnNldEF1dGhUYWcoQnVmZmVyLmZyb20oYXV0aFRhZywgXCJiYXNlNjRcIikpO1xuXG4gIGxldCBkZWNyeXB0ZWQgPSBkZWNpcGhlci51cGRhdGUoZW5jcnlwdGVkLCBcImJhc2U2NFwiLCBcInV0ZjhcIik7XG4gIGRlY3J5cHRlZCArPSBkZWNpcGhlci5maW5hbChcInV0ZjhcIik7XG5cbiAgcmV0dXJuIGRlY3J5cHRlZDtcbn1cbiJdLCJuYW1lcyI6WyJjcnlwdG8iLCJBTEdPUklUSE0iLCJJVl9MRU5HVEgiLCJBVVRIX1RBR19MRU5HVEgiLCJTQUxUIiwiZW5jcnlwdCIsInBsYWludGV4dCIsImVuY3J5cHRpb25LZXkiLCJrZXkiLCJzY3J5cHRTeW5jIiwiaXYiLCJyYW5kb21CeXRlcyIsImNpcGhlciIsImNyZWF0ZUNpcGhlcml2IiwiYXV0aFRhZ0xlbmd0aCIsImVuY3J5cHRlZCIsInVwZGF0ZSIsImZpbmFsIiwiYXV0aFRhZyIsImdldEF1dGhUYWciLCJ0b1N0cmluZyIsImRlY3J5cHQiLCJkZWNpcGhlciIsImNyZWF0ZURlY2lwaGVyaXYiLCJCdWZmZXIiLCJmcm9tIiwic2V0QXV0aFRhZyIsImRlY3J5cHRlZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/encryption.ts\n");

/***/ })

};
;