"use strict";(()=>{var e={};e.id=817,e.ids=[817,494],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},2345:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>y,patchFetch:()=>m,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var r={};s.r(r),s.d(r,{POST:()=>l,dynamic:()=>p});var a=s(9303),o=s(8716),n=s(670),u=s(7070),i=s(5662),c=s(6494);let p="force-dynamic";async function l(e){try{let{installationId:t,problemDescription:s}=await e.json();if(!t||!s)return u.NextResponse.json({success:!1,error:"Missing required fields"},{status:400});if(!e.cookies.get("github_user_id")?.value)return u.NextResponse.json({success:!1,error:"Not authenticated"},{status:401});let r=(0,i.l)(),{data:a,error:o}=await r.from("api_keys").select("encrypted_key, key_iv, key_auth_tag, key_type").eq("installation_id",t).single();if(o||!a)return u.NextResponse.json({success:!1,error:"API key not configured. Please save your API key first."},{status:400});let n=process.env.ENCRYPTION_KEY;if(!n)return u.NextResponse.json({success:!1,error:"Server configuration error"},{status:500});let p=(0,c.p)(a.encrypted_key,a.key_iv,a.key_auth_tag,n),l={"anthropic-version":"2023-06-01","content-type":"application/json"};"oauth_token"===a.key_type?l.Authorization=`Bearer ${p}`:l["x-api-key"]=p;let d=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:l,body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1024,messages:[{role:"user",content:`You are a helpful coding assistant. A user has described the following problem they want help with:

${s}

Please provide a helpful response. If this is a coding issue, suggest potential solutions or debugging steps. Keep your response concise but helpful.`}]})});if(!d.ok){let e=await d.json().catch(()=>({}));if(401===d.status)return u.NextResponse.json({success:!1,error:"API key is invalid or expired. Please update your API key."},{status:400});return u.NextResponse.json({success:!1,error:e.error?.message||`API error: ${d.status}`},{status:400})}let h=await d.json(),g=h.content?.[0]?.text||"No response received";return u.NextResponse.json({success:!0,response:g,model:h.model,usage:h.usage})}catch(e){return console.error("Test Claude error:",e),u.NextResponse.json({success:!1,error:"Failed to test API"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/test-claude/route",pathname:"/api/test-claude",filename:"route",bundlePath:"app/api/test-claude/route"},resolvedPagePath:"/Users/muralivvrsngurajapu/claude-bot/frontend/app/api/test-claude/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:f}=d,y="/api/test-claude/route";function m(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},6494:(e,t,s)=>{s.d(t,{encrypt:()=>u,p:()=>i});var r=s(4770),a=s.n(r);let o="aes-256-gcm",n="claude-bot-salt-v1";function u(e,t){let s=a().scryptSync(t,n,32),r=a().randomBytes(12),u=a().createCipheriv(o,s,r,{authTagLength:16}),i=u.update(e,"utf8","base64");i+=u.final("base64");let c=u.getAuthTag();return{encrypted:i,iv:r.toString("base64"),authTag:c.toString("base64")}}function i(e,t,s,r){let u=a().scryptSync(r,n,32),i=a().createDecipheriv(o,u,Buffer.from(t,"base64"),{authTagLength:16});return i.setAuthTag(Buffer.from(s,"base64")),i.update(e,"base64","utf8")+i.final("utf8")}},5662:(e,t,s)=>{s.d(t,{l:()=>a});var r=s(6596);function a(){return(0,r.eI)("https://riiisqzwbhlytogcjdmn.supabase.co",process.env.SUPABASE_SERVICE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,972,596],()=>s(2345));module.exports=r})();