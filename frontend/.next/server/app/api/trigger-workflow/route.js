"use strict";(()=>{var e={};e.id=612,e.ids=[612],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},8734:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>_,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{POST:()=>l,dynamic:()=>p});var o=r(9303),i=r(8716),a=r(670),n=r(7070),u=r(5662);let p="force-dynamic";async function l(e){try{let{apiKey:t,problemDescription:s,repoFullName:o}=await e.json();if(!t||!s||!o)return n.NextResponse.json({success:!1,error:"Missing required fields"},{status:400});if(!o.includes("/"))return n.NextResponse.json({success:!1,error:"Repository must be in format: owner/repo"},{status:400});let[i,a]=o.split("/");if(!e.cookies.get("github_user_id")?.value)return n.NextResponse.json({success:!1,error:"Not authenticated. Please go through setup page first."},{status:401});let p=(0,u.l)(),{data:l}=await p.from("installations").select("*").eq("account_login",i).single();if(!l)return n.NextResponse.json({success:!1,error:`GitHub App not installed on ${i}. Install it first.`},{status:404});let{encrypt:c}=await r.e(494).then(r.bind(r,6494)),d=process.env.ENCRYPTION_KEY,{encrypted:g,iv:f,authTag:_}=c(t,d);await p.from("api_keys").upsert({installation_id:l.installation_id,user_id:l.user_id,encrypted_key:g,key_iv:f,key_auth_tag:_,key_prefix:t.substring(0,15)+"...",key_type:"oauth_token",key_status:"active",last_validated_at:new Date().toISOString()},{onConflict:"installation_id"});let{App:h}=await r.e(655).then(r.bind(r,8655)),w=new h({appId:parseInt(process.env.APP_ID,10),privateKey:process.env.PRIVATE_KEY.replace(/\\n/g,"\n")}),m=await w.getInstallationOctokit(l.installation_id),{data:k}=await m.request("POST /repos/{owner}/{repo}/issues",{owner:i,repo:a,title:`Test: ${s.substring(0,60)}`,body:`@claude ${s}

---
*Created from test page*`,headers:{"X-GitHub-Api-Version":"2022-11-28"}});return n.NextResponse.json({success:!0,message:"Issue created! Webhook triggered. Check your repo for the PR.",issueUrl:k.html_url,issueNumber:k.number})}catch(e){return console.error("Trigger workflow error:",e),n.NextResponse.json({success:!1,error:e.message||"Failed to create issue"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/trigger-workflow/route",pathname:"/api/trigger-workflow",filename:"route",bundlePath:"app/api/trigger-workflow/route"},resolvedPagePath:"/Users/muralivvrsngurajapu/claude-bot/frontend/app/api/trigger-workflow/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:f}=c,_="/api/trigger-workflow/route";function h(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},5662:(e,t,r)=>{r.d(t,{l:()=>o});var s=r(6596);function o(){return(0,s.eI)("https://riiisqzwbhlytogcjdmn.supabase.co",process.env.SUPABASE_SERVICE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,596],()=>r(8734));module.exports=s})();