"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/toad-cache";
exports.ids = ["vendor-chunks/toad-cache"];
exports.modules = {

/***/ "(rsc)/./node_modules/toad-cache/dist/toad-cache.mjs":
/*!*****************************************************!*\
  !*** ./node_modules/toad-cache/dist/toad-cache.mjs ***!
  \*****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fifo: () => (/* binding */ FifoObject),\n/* harmony export */   FifoMap: () => (/* binding */ FifoMap),\n/* harmony export */   FifoObject: () => (/* binding */ FifoObject),\n/* harmony export */   HitStatisticsRecord: () => (/* binding */ HitStatisticsRecord),\n/* harmony export */   Lru: () => (/* binding */ LruObject),\n/* harmony export */   LruHitStatistics: () => (/* binding */ LruObjectHitStatistics),\n/* harmony export */   LruMap: () => (/* binding */ LruMap),\n/* harmony export */   LruObject: () => (/* binding */ LruObject),\n/* harmony export */   LruObjectHitStatistics: () => (/* binding */ LruObjectHitStatistics)\n/* harmony export */ });\n/**\n * toad-cache\n *\n * @copyright 2024 Igor Savin <kibertoad@gmail.com>\n * @license MIT\n * @version 3.7.0\n */\nclass FifoMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null;\n    this.items = new Map();\n    this.last = null;\n    this.max = max;\n    this.ttl = ttlInMsecs;\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  clear() {\n    this.items = new Map();\n    this.first = null;\n    this.last = null;\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const deletedItem = this.items.get(key);\n\n      this.items.delete(key);\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next;\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev;\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next;\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev;\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i]);\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first;\n\n      this.items.delete(item.key);\n\n      if (this.size === 0) {\n        this.first = null;\n        this.last = null;\n      } else {\n        this.first = item.next;\n        this.first.prev = null;\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key);\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key);\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = [];\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]));\n    }\n\n    return result\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key);\n      item.value = value;\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict();\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    };\n    this.items.set(key, item);\n\n    if (this.size === 1) {\n      this.first = item;\n    } else {\n      this.last.next = item;\n    }\n\n    this.last = item;\n  }\n}class LruMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null;\n    this.items = new Map();\n    this.last = null;\n    this.max = max;\n    this.ttl = ttlInMsecs;\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  bumpLru(item) {\n    if (this.last === item) {\n      return // Item is already the last one, no need to bump\n    }\n\n    const last = this.last;\n    const next = item.next;\n    const prev = item.prev;\n\n    if (this.first === item) {\n      this.first = next;\n    }\n\n    item.next = null;\n    item.prev = last;\n    last.next = item;\n\n    if (prev !== null) {\n      prev.next = next;\n    }\n\n    if (next !== null) {\n      next.prev = prev;\n    }\n\n    this.last = item;\n  }\n\n  clear() {\n    this.items = new Map();\n    this.first = null;\n    this.last = null;\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key);\n\n      this.items.delete(key);\n\n      if (item.prev !== null) {\n        item.prev.next = item.next;\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev;\n      }\n\n      if (this.first === item) {\n        this.first = item.next;\n      }\n\n      if (this.last === item) {\n        this.last = item.prev;\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i]);\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first;\n\n      this.items.delete(item.key);\n\n      if (this.size === 0) {\n        this.first = null;\n        this.last = null;\n      } else {\n        this.first = item.next;\n        this.first.prev = null;\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key);\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key);\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item);\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = [];\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]));\n    }\n\n    return result\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key);\n      item.value = value;\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\n      if (this.last !== item) {\n        this.bumpLru(item);\n      }\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict();\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    };\n    this.items.set(key, item);\n\n    if (this.size === 1) {\n      this.first = item;\n    } else {\n      this.last.next = item;\n    }\n\n    this.last = item;\n  }\n}class LruObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null;\n    this.items = Object.create(null);\n    this.last = null;\n    this.size = 0;\n    this.max = max;\n    this.ttl = ttlInMsecs;\n  }\n\n  bumpLru(item) {\n    if (this.last === item) {\n      return // Item is already the last one, no need to bump\n    }\n\n    const last = this.last;\n    const next = item.next;\n    const prev = item.prev;\n\n    if (this.first === item) {\n      this.first = next;\n    }\n\n    item.next = null;\n    item.prev = last;\n    last.next = item;\n\n    if (prev !== null) {\n      prev.next = next;\n    }\n\n    if (next !== null) {\n      next.prev = prev;\n    }\n\n    this.last = item;\n  }\n\n  clear() {\n    this.items = Object.create(null);\n    this.first = null;\n    this.last = null;\n    this.size = 0;\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key];\n\n      delete this.items[key];\n      this.size--;\n\n      if (item.prev !== null) {\n        item.prev.next = item.next;\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev;\n      }\n\n      if (this.first === item) {\n        this.first = item.next;\n      }\n\n      if (this.last === item) {\n        this.last = item.prev;\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i]);\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first;\n\n      delete this.items[item.key];\n\n      if (--this.size === 0) {\n        this.first = null;\n        this.last = null;\n      } else {\n        this.first = item.next;\n        this.first.prev = null;\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key];\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key);\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item);\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = [];\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]));\n    }\n\n    return result\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key];\n      item.value = value;\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\n      if (this.last !== item) {\n        this.bumpLru(item);\n      }\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict();\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    };\n    this.items[key] = item;\n\n    if (++this.size === 1) {\n      this.first = item;\n    } else {\n      this.last.next = item;\n    }\n\n    this.last = item;\n  }\n}class HitStatisticsRecord {\n  constructor() {\n    this.records = {};\n  }\n\n  initForCache(cacheId, currentTimeStamp) {\n    this.records[cacheId] = {\n      [currentTimeStamp]: {\n        cacheSize: 0,\n        hits: 0,\n        falsyHits: 0,\n        emptyHits: 0,\n        misses: 0,\n        expirations: 0,\n        evictions: 0,\n        invalidateOne: 0,\n        invalidateAll: 0,\n        sets: 0,\n      },\n    };\n  }\n\n  resetForCache(cacheId) {\n    for (let key of Object.keys(this.records[cacheId])) {\n      this.records[cacheId][key] = {\n        cacheSize: 0,\n        hits: 0,\n        falsyHits: 0,\n        emptyHits: 0,\n        misses: 0,\n        expirations: 0,\n        evictions: 0,\n        invalidateOne: 0,\n        invalidateAll: 0,\n        sets: 0,\n      };\n    }\n  }\n\n  getStatistics() {\n    return this.records\n  }\n}/**\n *\n * @param {Date} date\n * @returns {string}\n */\nfunction getTimestamp(date) {\n  return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date\n    .getDate()\n    .toString()\n    .padStart(2, '0')}`\n}class HitStatistics {\n  constructor(cacheId, statisticTtlInHours, globalStatisticsRecord) {\n    this.cacheId = cacheId;\n    this.statisticTtlInHours = statisticTtlInHours;\n\n    this.collectionStart = new Date();\n    this.currentTimeStamp = getTimestamp(this.collectionStart);\n\n    this.records = globalStatisticsRecord || new HitStatisticsRecord();\n    this.records.initForCache(this.cacheId, this.currentTimeStamp);\n  }\n\n  get currentRecord() {\n    // safety net\n    /* c8 ignore next 14 */\n    if (!this.records.records[this.cacheId][this.currentTimeStamp]) {\n      this.records.records[this.cacheId][this.currentTimeStamp] = {\n        cacheSize: 0,\n        hits: 0,\n        falsyHits: 0,\n        emptyHits: 0,\n        misses: 0,\n        expirations: 0,\n        evictions: 0,\n        sets: 0,\n        invalidateOne: 0,\n        invalidateAll: 0,\n      };\n    }\n\n    return this.records.records[this.cacheId][this.currentTimeStamp]\n  }\n\n  hoursPassed() {\n    return (Date.now() - this.collectionStart) / 1000 / 60 / 60\n  }\n\n  addHit() {\n    this.archiveIfNeeded();\n    this.currentRecord.hits++;\n  }\n  addFalsyHit() {\n    this.archiveIfNeeded();\n    this.currentRecord.falsyHits++;\n  }\n\n  addEmptyHit() {\n    this.archiveIfNeeded();\n    this.currentRecord.emptyHits++;\n  }\n\n  addMiss() {\n    this.archiveIfNeeded();\n    this.currentRecord.misses++;\n  }\n\n  addEviction() {\n    this.archiveIfNeeded();\n    this.currentRecord.evictions++;\n  }\n\n  setCacheSize(currentSize) {\n    this.archiveIfNeeded();\n    this.currentRecord.cacheSize = currentSize;\n  }\n\n  addExpiration() {\n    this.archiveIfNeeded();\n    this.currentRecord.expirations++;\n  }\n\n  addSet() {\n    this.archiveIfNeeded();\n    this.currentRecord.sets++;\n  }\n\n  addInvalidateOne() {\n    this.archiveIfNeeded();\n    this.currentRecord.invalidateOne++;\n  }\n\n  addInvalidateAll() {\n    this.archiveIfNeeded();\n    this.currentRecord.invalidateAll++;\n  }\n\n  getStatistics() {\n    return this.records.getStatistics()\n  }\n\n  archiveIfNeeded() {\n    if (this.hoursPassed() >= this.statisticTtlInHours) {\n      this.collectionStart = new Date();\n      this.currentTimeStamp = getTimestamp(this.collectionStart);\n      this.records.initForCache(this.cacheId, this.currentTimeStamp);\n    }\n  }\n}class LruObjectHitStatistics extends LruObject {\n  constructor(max, ttlInMsecs, cacheId, globalStatisticsRecord, statisticTtlInHours) {\n    super(max || 1000, ttlInMsecs || 0);\n\n    if (!cacheId) {\n      throw new Error('Cache id is mandatory')\n    }\n\n    this.hitStatistics = new HitStatistics(\n      cacheId,\n      statisticTtlInHours !== undefined ? statisticTtlInHours : 24,\n      globalStatisticsRecord,\n    );\n  }\n\n  getStatistics() {\n    return this.hitStatistics.getStatistics()\n  }\n\n  set(key, value) {\n    super.set(key, value);\n    this.hitStatistics.addSet();\n    this.hitStatistics.setCacheSize(this.size);\n  }\n\n  evict() {\n    super.evict();\n    this.hitStatistics.addEviction();\n    this.hitStatistics.setCacheSize(this.size);\n  }\n\n  delete(key, isExpiration = false) {\n    super.delete(key);\n\n    if (!isExpiration) {\n      this.hitStatistics.addInvalidateOne();\n    }\n    this.hitStatistics.setCacheSize(this.size);\n  }\n\n  clear() {\n    super.clear();\n\n    this.hitStatistics.addInvalidateAll();\n    this.hitStatistics.setCacheSize(this.size);\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key];\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key, true);\n        this.hitStatistics.addExpiration();\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item);\n      if (!item.value) {\n        this.hitStatistics.addFalsyHit();\n      }\n      if (item.value === undefined || item.value === null || item.value === '') {\n        this.hitStatistics.addEmptyHit();\n      }\n      this.hitStatistics.addHit();\n      return item.value\n    }\n    this.hitStatistics.addMiss();\n  }\n}class FifoObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null;\n    this.items = Object.create(null);\n    this.last = null;\n    this.size = 0;\n    this.max = max;\n    this.ttl = ttlInMsecs;\n  }\n\n  clear() {\n    this.items = Object.create(null);\n    this.first = null;\n    this.last = null;\n    this.size = 0;\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const deletedItem = this.items[key];\n\n      delete this.items[key];\n      this.size--;\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next;\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev;\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next;\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev;\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i]);\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first;\n\n      delete this.items[item.key];\n\n      if (--this.size === 0) {\n        this.first = null;\n        this.last = null;\n      } else {\n        this.first = item.next;\n        this.first.prev = null;\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key];\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key);\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = [];\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]));\n    }\n\n    return result\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key];\n      item.value = value;\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict();\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    };\n    this.items[key] = item;\n\n    if (++this.size === 1) {\n      this.first = item;\n    } else {\n      this.last.next = item;\n    }\n\n    this.last = item;\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdG9hZC1jYWNoZS9kaXN0L3RvYWQtY2FjaGUubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CLGlCQUFpQjtBQUNyQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CLGlCQUFpQjtBQUNyQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxXQUFXLE1BQU07QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQSxZQUFZLG1CQUFtQixHQUFHLGtEQUFrRCxHQUFHO0FBQ3ZGO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEIsQ0FBQztBQUNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBOztBQUVBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2NsYXVkZS1ib3Qtc2V0dXAvLi9ub2RlX21vZHVsZXMvdG9hZC1jYWNoZS9kaXN0L3RvYWQtY2FjaGUubWpzPzI5ZGIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiB0b2FkLWNhY2hlXG4gKlxuICogQGNvcHlyaWdodCAyMDI0IElnb3IgU2F2aW4gPGtpYmVydG9hZEBnbWFpbC5jb20+XG4gKiBAbGljZW5zZSBNSVRcbiAqIEB2ZXJzaW9uIDMuNy4wXG4gKi9cbmNsYXNzIEZpZm9NYXAge1xuICBjb25zdHJ1Y3RvcihtYXggPSAxMDAwLCB0dGxJbk1zZWNzID0gMCkge1xuICAgIGlmIChpc05hTihtYXgpIHx8IG1heCA8IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBtYXggdmFsdWUnKVxuICAgIH1cblxuICAgIGlmIChpc05hTih0dGxJbk1zZWNzKSB8fCB0dGxJbk1zZWNzIDwgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHR0bCB2YWx1ZScpXG4gICAgfVxuXG4gICAgdGhpcy5maXJzdCA9IG51bGw7XG4gICAgdGhpcy5pdGVtcyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmxhc3QgPSBudWxsO1xuICAgIHRoaXMubWF4ID0gbWF4O1xuICAgIHRoaXMudHRsID0gdHRsSW5Nc2VjcztcbiAgfVxuXG4gIGdldCBzaXplKCkge1xuICAgIHJldHVybiB0aGlzLml0ZW1zLnNpemVcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuaXRlbXMgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5maXJzdCA9IG51bGw7XG4gICAgdGhpcy5sYXN0ID0gbnVsbDtcbiAgfVxuXG4gIGRlbGV0ZShrZXkpIHtcbiAgICBpZiAodGhpcy5pdGVtcy5oYXMoa2V5KSkge1xuICAgICAgY29uc3QgZGVsZXRlZEl0ZW0gPSB0aGlzLml0ZW1zLmdldChrZXkpO1xuXG4gICAgICB0aGlzLml0ZW1zLmRlbGV0ZShrZXkpO1xuXG4gICAgICBpZiAoZGVsZXRlZEl0ZW0ucHJldiAhPT0gbnVsbCkge1xuICAgICAgICBkZWxldGVkSXRlbS5wcmV2Lm5leHQgPSBkZWxldGVkSXRlbS5uZXh0O1xuICAgICAgfVxuXG4gICAgICBpZiAoZGVsZXRlZEl0ZW0ubmV4dCAhPT0gbnVsbCkge1xuICAgICAgICBkZWxldGVkSXRlbS5uZXh0LnByZXYgPSBkZWxldGVkSXRlbS5wcmV2O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5maXJzdCA9PT0gZGVsZXRlZEl0ZW0pIHtcbiAgICAgICAgdGhpcy5maXJzdCA9IGRlbGV0ZWRJdGVtLm5leHQ7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmxhc3QgPT09IGRlbGV0ZWRJdGVtKSB7XG4gICAgICAgIHRoaXMubGFzdCA9IGRlbGV0ZWRJdGVtLnByZXY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZGVsZXRlTWFueShrZXlzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmRlbGV0ZShrZXlzW2ldKTtcbiAgICB9XG4gIH1cblxuICBldmljdCgpIHtcbiAgICBpZiAodGhpcy5zaXplID4gMCkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZmlyc3Q7XG5cbiAgICAgIHRoaXMuaXRlbXMuZGVsZXRlKGl0ZW0ua2V5KTtcblxuICAgICAgaWYgKHRoaXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLmZpcnN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5sYXN0ID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZmlyc3QgPSBpdGVtLm5leHQ7XG4gICAgICAgIHRoaXMuZmlyc3QucHJldiA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZXhwaXJlc0F0KGtleSkge1xuICAgIGlmICh0aGlzLml0ZW1zLmhhcyhrZXkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtcy5nZXQoa2V5KS5leHBpcnlcbiAgICB9XG4gIH1cblxuICBnZXQoa2V5KSB7XG4gICAgaWYgKHRoaXMuaXRlbXMuaGFzKGtleSkpIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLml0ZW1zLmdldChrZXkpO1xuXG4gICAgICBpZiAodGhpcy50dGwgPiAwICYmIGl0ZW0uZXhwaXJ5IDw9IERhdGUubm93KCkpIHtcbiAgICAgICAgdGhpcy5kZWxldGUoa2V5KTtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBpdGVtLnZhbHVlXG4gICAgfVxuICB9XG5cbiAgZ2V0TWFueShrZXlzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdC5wdXNoKHRoaXMuZ2V0KGtleXNbaV0pKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICBrZXlzKCkge1xuICAgIHJldHVybiB0aGlzLml0ZW1zLmtleXMoKVxuICB9XG5cbiAgc2V0KGtleSwgdmFsdWUpIHtcbiAgICAvLyBSZXBsYWNlIGV4aXN0aW5nIGl0ZW1cbiAgICBpZiAodGhpcy5pdGVtcy5oYXMoa2V5KSkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXMuZ2V0KGtleSk7XG4gICAgICBpdGVtLnZhbHVlID0gdmFsdWU7XG5cbiAgICAgIGl0ZW0uZXhwaXJ5ID0gdGhpcy50dGwgPiAwID8gRGF0ZS5ub3coKSArIHRoaXMudHRsIDogdGhpcy50dGw7XG5cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIEFkZCBuZXcgaXRlbVxuICAgIGlmICh0aGlzLm1heCA+IDAgJiYgdGhpcy5zaXplID09PSB0aGlzLm1heCkge1xuICAgICAgdGhpcy5ldmljdCgpO1xuICAgIH1cblxuICAgIGNvbnN0IGl0ZW0gPSB7XG4gICAgICBleHBpcnk6IHRoaXMudHRsID4gMCA/IERhdGUubm93KCkgKyB0aGlzLnR0bCA6IHRoaXMudHRsLFxuICAgICAga2V5OiBrZXksXG4gICAgICBwcmV2OiB0aGlzLmxhc3QsXG4gICAgICBuZXh0OiBudWxsLFxuICAgICAgdmFsdWUsXG4gICAgfTtcbiAgICB0aGlzLml0ZW1zLnNldChrZXksIGl0ZW0pO1xuXG4gICAgaWYgKHRoaXMuc2l6ZSA9PT0gMSkge1xuICAgICAgdGhpcy5maXJzdCA9IGl0ZW07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGFzdC5uZXh0ID0gaXRlbTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBpdGVtO1xuICB9XG59Y2xhc3MgTHJ1TWFwIHtcbiAgY29uc3RydWN0b3IobWF4ID0gMTAwMCwgdHRsSW5Nc2VjcyA9IDApIHtcbiAgICBpZiAoaXNOYU4obWF4KSB8fCBtYXggPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgbWF4IHZhbHVlJylcbiAgICB9XG5cbiAgICBpZiAoaXNOYU4odHRsSW5Nc2VjcykgfHwgdHRsSW5Nc2VjcyA8IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0dGwgdmFsdWUnKVxuICAgIH1cblxuICAgIHRoaXMuZmlyc3QgPSBudWxsO1xuICAgIHRoaXMuaXRlbXMgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5sYXN0ID0gbnVsbDtcbiAgICB0aGlzLm1heCA9IG1heDtcbiAgICB0aGlzLnR0bCA9IHR0bEluTXNlY3M7XG4gIH1cblxuICBnZXQgc2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5pdGVtcy5zaXplXG4gIH1cblxuICBidW1wTHJ1KGl0ZW0pIHtcbiAgICBpZiAodGhpcy5sYXN0ID09PSBpdGVtKSB7XG4gICAgICByZXR1cm4gLy8gSXRlbSBpcyBhbHJlYWR5IHRoZSBsYXN0IG9uZSwgbm8gbmVlZCB0byBidW1wXG4gICAgfVxuXG4gICAgY29uc3QgbGFzdCA9IHRoaXMubGFzdDtcbiAgICBjb25zdCBuZXh0ID0gaXRlbS5uZXh0O1xuICAgIGNvbnN0IHByZXYgPSBpdGVtLnByZXY7XG5cbiAgICBpZiAodGhpcy5maXJzdCA9PT0gaXRlbSkge1xuICAgICAgdGhpcy5maXJzdCA9IG5leHQ7XG4gICAgfVxuXG4gICAgaXRlbS5uZXh0ID0gbnVsbDtcbiAgICBpdGVtLnByZXYgPSBsYXN0O1xuICAgIGxhc3QubmV4dCA9IGl0ZW07XG5cbiAgICBpZiAocHJldiAhPT0gbnVsbCkge1xuICAgICAgcHJldi5uZXh0ID0gbmV4dDtcbiAgICB9XG5cbiAgICBpZiAobmV4dCAhPT0gbnVsbCkge1xuICAgICAgbmV4dC5wcmV2ID0gcHJldjtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBpdGVtO1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5pdGVtcyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmZpcnN0ID0gbnVsbDtcbiAgICB0aGlzLmxhc3QgPSBudWxsO1xuICB9XG5cbiAgZGVsZXRlKGtleSkge1xuICAgIGlmICh0aGlzLml0ZW1zLmhhcyhrZXkpKSB7XG4gICAgICBjb25zdCBpdGVtID0gdGhpcy5pdGVtcy5nZXQoa2V5KTtcblxuICAgICAgdGhpcy5pdGVtcy5kZWxldGUoa2V5KTtcblxuICAgICAgaWYgKGl0ZW0ucHJldiAhPT0gbnVsbCkge1xuICAgICAgICBpdGVtLnByZXYubmV4dCA9IGl0ZW0ubmV4dDtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0ubmV4dCAhPT0gbnVsbCkge1xuICAgICAgICBpdGVtLm5leHQucHJldiA9IGl0ZW0ucHJldjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuZmlyc3QgPT09IGl0ZW0pIHtcbiAgICAgICAgdGhpcy5maXJzdCA9IGl0ZW0ubmV4dDtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMubGFzdCA9PT0gaXRlbSkge1xuICAgICAgICB0aGlzLmxhc3QgPSBpdGVtLnByZXY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZGVsZXRlTWFueShrZXlzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmRlbGV0ZShrZXlzW2ldKTtcbiAgICB9XG4gIH1cblxuICBldmljdCgpIHtcbiAgICBpZiAodGhpcy5zaXplID4gMCkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZmlyc3Q7XG5cbiAgICAgIHRoaXMuaXRlbXMuZGVsZXRlKGl0ZW0ua2V5KTtcblxuICAgICAgaWYgKHRoaXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLmZpcnN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5sYXN0ID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZmlyc3QgPSBpdGVtLm5leHQ7XG4gICAgICAgIHRoaXMuZmlyc3QucHJldiA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZXhwaXJlc0F0KGtleSkge1xuICAgIGlmICh0aGlzLml0ZW1zLmhhcyhrZXkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtcy5nZXQoa2V5KS5leHBpcnlcbiAgICB9XG4gIH1cblxuICBnZXQoa2V5KSB7XG4gICAgaWYgKHRoaXMuaXRlbXMuaGFzKGtleSkpIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLml0ZW1zLmdldChrZXkpO1xuXG4gICAgICAvLyBJdGVtIGhhcyBhbHJlYWR5IGV4cGlyZWRcbiAgICAgIGlmICh0aGlzLnR0bCA+IDAgJiYgaXRlbS5leHBpcnkgPD0gRGF0ZS5ub3coKSkge1xuICAgICAgICB0aGlzLmRlbGV0ZShrZXkpO1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8gSXRlbSBpcyBzdGlsbCBmcmVzaFxuICAgICAgdGhpcy5idW1wTHJ1KGl0ZW0pO1xuICAgICAgcmV0dXJuIGl0ZW0udmFsdWVcbiAgICB9XG4gIH1cblxuICBnZXRNYW55KGtleXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0LnB1c2godGhpcy5nZXQoa2V5c1tpXSkpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIGtleXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXRlbXMua2V5cygpXG4gIH1cblxuICBzZXQoa2V5LCB2YWx1ZSkge1xuICAgIC8vIFJlcGxhY2UgZXhpc3RpbmcgaXRlbVxuICAgIGlmICh0aGlzLml0ZW1zLmhhcyhrZXkpKSB7XG4gICAgICBjb25zdCBpdGVtID0gdGhpcy5pdGVtcy5nZXQoa2V5KTtcbiAgICAgIGl0ZW0udmFsdWUgPSB2YWx1ZTtcblxuICAgICAgaXRlbS5leHBpcnkgPSB0aGlzLnR0bCA+IDAgPyBEYXRlLm5vdygpICsgdGhpcy50dGwgOiB0aGlzLnR0bDtcblxuICAgICAgaWYgKHRoaXMubGFzdCAhPT0gaXRlbSkge1xuICAgICAgICB0aGlzLmJ1bXBMcnUoaXRlbSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIEFkZCBuZXcgaXRlbVxuICAgIGlmICh0aGlzLm1heCA+IDAgJiYgdGhpcy5zaXplID09PSB0aGlzLm1heCkge1xuICAgICAgdGhpcy5ldmljdCgpO1xuICAgIH1cblxuICAgIGNvbnN0IGl0ZW0gPSB7XG4gICAgICBleHBpcnk6IHRoaXMudHRsID4gMCA/IERhdGUubm93KCkgKyB0aGlzLnR0bCA6IHRoaXMudHRsLFxuICAgICAga2V5OiBrZXksXG4gICAgICBwcmV2OiB0aGlzLmxhc3QsXG4gICAgICBuZXh0OiBudWxsLFxuICAgICAgdmFsdWUsXG4gICAgfTtcbiAgICB0aGlzLml0ZW1zLnNldChrZXksIGl0ZW0pO1xuXG4gICAgaWYgKHRoaXMuc2l6ZSA9PT0gMSkge1xuICAgICAgdGhpcy5maXJzdCA9IGl0ZW07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGFzdC5uZXh0ID0gaXRlbTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBpdGVtO1xuICB9XG59Y2xhc3MgTHJ1T2JqZWN0IHtcbiAgY29uc3RydWN0b3IobWF4ID0gMTAwMCwgdHRsSW5Nc2VjcyA9IDApIHtcbiAgICBpZiAoaXNOYU4obWF4KSB8fCBtYXggPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgbWF4IHZhbHVlJylcbiAgICB9XG5cbiAgICBpZiAoaXNOYU4odHRsSW5Nc2VjcykgfHwgdHRsSW5Nc2VjcyA8IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0dGwgdmFsdWUnKVxuICAgIH1cblxuICAgIHRoaXMuZmlyc3QgPSBudWxsO1xuICAgIHRoaXMuaXRlbXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMubGFzdCA9IG51bGw7XG4gICAgdGhpcy5zaXplID0gMDtcbiAgICB0aGlzLm1heCA9IG1heDtcbiAgICB0aGlzLnR0bCA9IHR0bEluTXNlY3M7XG4gIH1cblxuICBidW1wTHJ1KGl0ZW0pIHtcbiAgICBpZiAodGhpcy5sYXN0ID09PSBpdGVtKSB7XG4gICAgICByZXR1cm4gLy8gSXRlbSBpcyBhbHJlYWR5IHRoZSBsYXN0IG9uZSwgbm8gbmVlZCB0byBidW1wXG4gICAgfVxuXG4gICAgY29uc3QgbGFzdCA9IHRoaXMubGFzdDtcbiAgICBjb25zdCBuZXh0ID0gaXRlbS5uZXh0O1xuICAgIGNvbnN0IHByZXYgPSBpdGVtLnByZXY7XG5cbiAgICBpZiAodGhpcy5maXJzdCA9PT0gaXRlbSkge1xuICAgICAgdGhpcy5maXJzdCA9IG5leHQ7XG4gICAgfVxuXG4gICAgaXRlbS5uZXh0ID0gbnVsbDtcbiAgICBpdGVtLnByZXYgPSBsYXN0O1xuICAgIGxhc3QubmV4dCA9IGl0ZW07XG5cbiAgICBpZiAocHJldiAhPT0gbnVsbCkge1xuICAgICAgcHJldi5uZXh0ID0gbmV4dDtcbiAgICB9XG5cbiAgICBpZiAobmV4dCAhPT0gbnVsbCkge1xuICAgICAgbmV4dC5wcmV2ID0gcHJldjtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBpdGVtO1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5pdGVtcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgdGhpcy5maXJzdCA9IG51bGw7XG4gICAgdGhpcy5sYXN0ID0gbnVsbDtcbiAgICB0aGlzLnNpemUgPSAwO1xuICB9XG5cbiAgZGVsZXRlKGtleSkge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5pdGVtcywga2V5KSkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXNba2V5XTtcblxuICAgICAgZGVsZXRlIHRoaXMuaXRlbXNba2V5XTtcbiAgICAgIHRoaXMuc2l6ZS0tO1xuXG4gICAgICBpZiAoaXRlbS5wcmV2ICE9PSBudWxsKSB7XG4gICAgICAgIGl0ZW0ucHJldi5uZXh0ID0gaXRlbS5uZXh0O1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS5uZXh0ICE9PSBudWxsKSB7XG4gICAgICAgIGl0ZW0ubmV4dC5wcmV2ID0gaXRlbS5wcmV2O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5maXJzdCA9PT0gaXRlbSkge1xuICAgICAgICB0aGlzLmZpcnN0ID0gaXRlbS5uZXh0O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5sYXN0ID09PSBpdGVtKSB7XG4gICAgICAgIHRoaXMubGFzdCA9IGl0ZW0ucHJldjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBkZWxldGVNYW55KGtleXMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuZGVsZXRlKGtleXNbaV0pO1xuICAgIH1cbiAgfVxuXG4gIGV2aWN0KCkge1xuICAgIGlmICh0aGlzLnNpemUgPiAwKSB7XG4gICAgICBjb25zdCBpdGVtID0gdGhpcy5maXJzdDtcblxuICAgICAgZGVsZXRlIHRoaXMuaXRlbXNbaXRlbS5rZXldO1xuXG4gICAgICBpZiAoLS10aGlzLnNpemUgPT09IDApIHtcbiAgICAgICAgdGhpcy5maXJzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubGFzdCA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmZpcnN0ID0gaXRlbS5uZXh0O1xuICAgICAgICB0aGlzLmZpcnN0LnByZXYgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGV4cGlyZXNBdChrZXkpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuaXRlbXMsIGtleSkpIHtcbiAgICAgIHJldHVybiB0aGlzLml0ZW1zW2tleV0uZXhwaXJ5XG4gICAgfVxuICB9XG5cbiAgZ2V0KGtleSkge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5pdGVtcywga2V5KSkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXNba2V5XTtcblxuICAgICAgLy8gSXRlbSBoYXMgYWxyZWFkeSBleHBpcmVkXG4gICAgICBpZiAodGhpcy50dGwgPiAwICYmIGl0ZW0uZXhwaXJ5IDw9IERhdGUubm93KCkpIHtcbiAgICAgICAgdGhpcy5kZWxldGUoa2V5KTtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIC8vIEl0ZW0gaXMgc3RpbGwgZnJlc2hcbiAgICAgIHRoaXMuYnVtcExydShpdGVtKTtcbiAgICAgIHJldHVybiBpdGVtLnZhbHVlXG4gICAgfVxuICB9XG5cbiAgZ2V0TWFueShrZXlzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdC5wdXNoKHRoaXMuZ2V0KGtleXNbaV0pKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICBrZXlzKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLml0ZW1zKVxuICB9XG5cbiAgc2V0KGtleSwgdmFsdWUpIHtcbiAgICAvLyBSZXBsYWNlIGV4aXN0aW5nIGl0ZW1cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuaXRlbXMsIGtleSkpIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLml0ZW1zW2tleV07XG4gICAgICBpdGVtLnZhbHVlID0gdmFsdWU7XG5cbiAgICAgIGl0ZW0uZXhwaXJ5ID0gdGhpcy50dGwgPiAwID8gRGF0ZS5ub3coKSArIHRoaXMudHRsIDogdGhpcy50dGw7XG5cbiAgICAgIGlmICh0aGlzLmxhc3QgIT09IGl0ZW0pIHtcbiAgICAgICAgdGhpcy5idW1wTHJ1KGl0ZW0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBBZGQgbmV3IGl0ZW1cbiAgICBpZiAodGhpcy5tYXggPiAwICYmIHRoaXMuc2l6ZSA9PT0gdGhpcy5tYXgpIHtcbiAgICAgIHRoaXMuZXZpY3QoKTtcbiAgICB9XG5cbiAgICBjb25zdCBpdGVtID0ge1xuICAgICAgZXhwaXJ5OiB0aGlzLnR0bCA+IDAgPyBEYXRlLm5vdygpICsgdGhpcy50dGwgOiB0aGlzLnR0bCxcbiAgICAgIGtleToga2V5LFxuICAgICAgcHJldjogdGhpcy5sYXN0LFxuICAgICAgbmV4dDogbnVsbCxcbiAgICAgIHZhbHVlLFxuICAgIH07XG4gICAgdGhpcy5pdGVtc1trZXldID0gaXRlbTtcblxuICAgIGlmICgrK3RoaXMuc2l6ZSA9PT0gMSkge1xuICAgICAgdGhpcy5maXJzdCA9IGl0ZW07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGFzdC5uZXh0ID0gaXRlbTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBpdGVtO1xuICB9XG59Y2xhc3MgSGl0U3RhdGlzdGljc1JlY29yZCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucmVjb3JkcyA9IHt9O1xuICB9XG5cbiAgaW5pdEZvckNhY2hlKGNhY2hlSWQsIGN1cnJlbnRUaW1lU3RhbXApIHtcbiAgICB0aGlzLnJlY29yZHNbY2FjaGVJZF0gPSB7XG4gICAgICBbY3VycmVudFRpbWVTdGFtcF06IHtcbiAgICAgICAgY2FjaGVTaXplOiAwLFxuICAgICAgICBoaXRzOiAwLFxuICAgICAgICBmYWxzeUhpdHM6IDAsXG4gICAgICAgIGVtcHR5SGl0czogMCxcbiAgICAgICAgbWlzc2VzOiAwLFxuICAgICAgICBleHBpcmF0aW9uczogMCxcbiAgICAgICAgZXZpY3Rpb25zOiAwLFxuICAgICAgICBpbnZhbGlkYXRlT25lOiAwLFxuICAgICAgICBpbnZhbGlkYXRlQWxsOiAwLFxuICAgICAgICBzZXRzOiAwLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgcmVzZXRGb3JDYWNoZShjYWNoZUlkKSB7XG4gICAgZm9yIChsZXQga2V5IG9mIE9iamVjdC5rZXlzKHRoaXMucmVjb3Jkc1tjYWNoZUlkXSkpIHtcbiAgICAgIHRoaXMucmVjb3Jkc1tjYWNoZUlkXVtrZXldID0ge1xuICAgICAgICBjYWNoZVNpemU6IDAsXG4gICAgICAgIGhpdHM6IDAsXG4gICAgICAgIGZhbHN5SGl0czogMCxcbiAgICAgICAgZW1wdHlIaXRzOiAwLFxuICAgICAgICBtaXNzZXM6IDAsXG4gICAgICAgIGV4cGlyYXRpb25zOiAwLFxuICAgICAgICBldmljdGlvbnM6IDAsXG4gICAgICAgIGludmFsaWRhdGVPbmU6IDAsXG4gICAgICAgIGludmFsaWRhdGVBbGw6IDAsXG4gICAgICAgIHNldHM6IDAsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGdldFN0YXRpc3RpY3MoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVjb3Jkc1xuICB9XG59LyoqXG4gKlxuICogQHBhcmFtIHtEYXRlfSBkYXRlXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRUaW1lc3RhbXAoZGF0ZSkge1xuICByZXR1cm4gYCR7ZGF0ZS5nZXRGdWxsWWVhcigpfS0keyhkYXRlLmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9LSR7ZGF0ZVxuICAgIC5nZXREYXRlKClcbiAgICAudG9TdHJpbmcoKVxuICAgIC5wYWRTdGFydCgyLCAnMCcpfWBcbn1jbGFzcyBIaXRTdGF0aXN0aWNzIHtcbiAgY29uc3RydWN0b3IoY2FjaGVJZCwgc3RhdGlzdGljVHRsSW5Ib3VycywgZ2xvYmFsU3RhdGlzdGljc1JlY29yZCkge1xuICAgIHRoaXMuY2FjaGVJZCA9IGNhY2hlSWQ7XG4gICAgdGhpcy5zdGF0aXN0aWNUdGxJbkhvdXJzID0gc3RhdGlzdGljVHRsSW5Ib3VycztcblxuICAgIHRoaXMuY29sbGVjdGlvblN0YXJ0ID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLmN1cnJlbnRUaW1lU3RhbXAgPSBnZXRUaW1lc3RhbXAodGhpcy5jb2xsZWN0aW9uU3RhcnQpO1xuXG4gICAgdGhpcy5yZWNvcmRzID0gZ2xvYmFsU3RhdGlzdGljc1JlY29yZCB8fCBuZXcgSGl0U3RhdGlzdGljc1JlY29yZCgpO1xuICAgIHRoaXMucmVjb3Jkcy5pbml0Rm9yQ2FjaGUodGhpcy5jYWNoZUlkLCB0aGlzLmN1cnJlbnRUaW1lU3RhbXApO1xuICB9XG5cbiAgZ2V0IGN1cnJlbnRSZWNvcmQoKSB7XG4gICAgLy8gc2FmZXR5IG5ldFxuICAgIC8qIGM4IGlnbm9yZSBuZXh0IDE0ICovXG4gICAgaWYgKCF0aGlzLnJlY29yZHMucmVjb3Jkc1t0aGlzLmNhY2hlSWRdW3RoaXMuY3VycmVudFRpbWVTdGFtcF0pIHtcbiAgICAgIHRoaXMucmVjb3Jkcy5yZWNvcmRzW3RoaXMuY2FjaGVJZF1bdGhpcy5jdXJyZW50VGltZVN0YW1wXSA9IHtcbiAgICAgICAgY2FjaGVTaXplOiAwLFxuICAgICAgICBoaXRzOiAwLFxuICAgICAgICBmYWxzeUhpdHM6IDAsXG4gICAgICAgIGVtcHR5SGl0czogMCxcbiAgICAgICAgbWlzc2VzOiAwLFxuICAgICAgICBleHBpcmF0aW9uczogMCxcbiAgICAgICAgZXZpY3Rpb25zOiAwLFxuICAgICAgICBzZXRzOiAwLFxuICAgICAgICBpbnZhbGlkYXRlT25lOiAwLFxuICAgICAgICBpbnZhbGlkYXRlQWxsOiAwLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5yZWNvcmRzLnJlY29yZHNbdGhpcy5jYWNoZUlkXVt0aGlzLmN1cnJlbnRUaW1lU3RhbXBdXG4gIH1cblxuICBob3Vyc1Bhc3NlZCgpIHtcbiAgICByZXR1cm4gKERhdGUubm93KCkgLSB0aGlzLmNvbGxlY3Rpb25TdGFydCkgLyAxMDAwIC8gNjAgLyA2MFxuICB9XG5cbiAgYWRkSGl0KCkge1xuICAgIHRoaXMuYXJjaGl2ZUlmTmVlZGVkKCk7XG4gICAgdGhpcy5jdXJyZW50UmVjb3JkLmhpdHMrKztcbiAgfVxuICBhZGRGYWxzeUhpdCgpIHtcbiAgICB0aGlzLmFyY2hpdmVJZk5lZWRlZCgpO1xuICAgIHRoaXMuY3VycmVudFJlY29yZC5mYWxzeUhpdHMrKztcbiAgfVxuXG4gIGFkZEVtcHR5SGl0KCkge1xuICAgIHRoaXMuYXJjaGl2ZUlmTmVlZGVkKCk7XG4gICAgdGhpcy5jdXJyZW50UmVjb3JkLmVtcHR5SGl0cysrO1xuICB9XG5cbiAgYWRkTWlzcygpIHtcbiAgICB0aGlzLmFyY2hpdmVJZk5lZWRlZCgpO1xuICAgIHRoaXMuY3VycmVudFJlY29yZC5taXNzZXMrKztcbiAgfVxuXG4gIGFkZEV2aWN0aW9uKCkge1xuICAgIHRoaXMuYXJjaGl2ZUlmTmVlZGVkKCk7XG4gICAgdGhpcy5jdXJyZW50UmVjb3JkLmV2aWN0aW9ucysrO1xuICB9XG5cbiAgc2V0Q2FjaGVTaXplKGN1cnJlbnRTaXplKSB7XG4gICAgdGhpcy5hcmNoaXZlSWZOZWVkZWQoKTtcbiAgICB0aGlzLmN1cnJlbnRSZWNvcmQuY2FjaGVTaXplID0gY3VycmVudFNpemU7XG4gIH1cblxuICBhZGRFeHBpcmF0aW9uKCkge1xuICAgIHRoaXMuYXJjaGl2ZUlmTmVlZGVkKCk7XG4gICAgdGhpcy5jdXJyZW50UmVjb3JkLmV4cGlyYXRpb25zKys7XG4gIH1cblxuICBhZGRTZXQoKSB7XG4gICAgdGhpcy5hcmNoaXZlSWZOZWVkZWQoKTtcbiAgICB0aGlzLmN1cnJlbnRSZWNvcmQuc2V0cysrO1xuICB9XG5cbiAgYWRkSW52YWxpZGF0ZU9uZSgpIHtcbiAgICB0aGlzLmFyY2hpdmVJZk5lZWRlZCgpO1xuICAgIHRoaXMuY3VycmVudFJlY29yZC5pbnZhbGlkYXRlT25lKys7XG4gIH1cblxuICBhZGRJbnZhbGlkYXRlQWxsKCkge1xuICAgIHRoaXMuYXJjaGl2ZUlmTmVlZGVkKCk7XG4gICAgdGhpcy5jdXJyZW50UmVjb3JkLmludmFsaWRhdGVBbGwrKztcbiAgfVxuXG4gIGdldFN0YXRpc3RpY3MoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVjb3Jkcy5nZXRTdGF0aXN0aWNzKClcbiAgfVxuXG4gIGFyY2hpdmVJZk5lZWRlZCgpIHtcbiAgICBpZiAodGhpcy5ob3Vyc1Bhc3NlZCgpID49IHRoaXMuc3RhdGlzdGljVHRsSW5Ib3Vycykge1xuICAgICAgdGhpcy5jb2xsZWN0aW9uU3RhcnQgPSBuZXcgRGF0ZSgpO1xuICAgICAgdGhpcy5jdXJyZW50VGltZVN0YW1wID0gZ2V0VGltZXN0YW1wKHRoaXMuY29sbGVjdGlvblN0YXJ0KTtcbiAgICAgIHRoaXMucmVjb3Jkcy5pbml0Rm9yQ2FjaGUodGhpcy5jYWNoZUlkLCB0aGlzLmN1cnJlbnRUaW1lU3RhbXApO1xuICAgIH1cbiAgfVxufWNsYXNzIExydU9iamVjdEhpdFN0YXRpc3RpY3MgZXh0ZW5kcyBMcnVPYmplY3Qge1xuICBjb25zdHJ1Y3RvcihtYXgsIHR0bEluTXNlY3MsIGNhY2hlSWQsIGdsb2JhbFN0YXRpc3RpY3NSZWNvcmQsIHN0YXRpc3RpY1R0bEluSG91cnMpIHtcbiAgICBzdXBlcihtYXggfHwgMTAwMCwgdHRsSW5Nc2VjcyB8fCAwKTtcblxuICAgIGlmICghY2FjaGVJZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYWNoZSBpZCBpcyBtYW5kYXRvcnknKVxuICAgIH1cblxuICAgIHRoaXMuaGl0U3RhdGlzdGljcyA9IG5ldyBIaXRTdGF0aXN0aWNzKFxuICAgICAgY2FjaGVJZCxcbiAgICAgIHN0YXRpc3RpY1R0bEluSG91cnMgIT09IHVuZGVmaW5lZCA/IHN0YXRpc3RpY1R0bEluSG91cnMgOiAyNCxcbiAgICAgIGdsb2JhbFN0YXRpc3RpY3NSZWNvcmQsXG4gICAgKTtcbiAgfVxuXG4gIGdldFN0YXRpc3RpY3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGl0U3RhdGlzdGljcy5nZXRTdGF0aXN0aWNzKClcbiAgfVxuXG4gIHNldChrZXksIHZhbHVlKSB7XG4gICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpO1xuICAgIHRoaXMuaGl0U3RhdGlzdGljcy5hZGRTZXQoKTtcbiAgICB0aGlzLmhpdFN0YXRpc3RpY3Muc2V0Q2FjaGVTaXplKHRoaXMuc2l6ZSk7XG4gIH1cblxuICBldmljdCgpIHtcbiAgICBzdXBlci5ldmljdCgpO1xuICAgIHRoaXMuaGl0U3RhdGlzdGljcy5hZGRFdmljdGlvbigpO1xuICAgIHRoaXMuaGl0U3RhdGlzdGljcy5zZXRDYWNoZVNpemUodGhpcy5zaXplKTtcbiAgfVxuXG4gIGRlbGV0ZShrZXksIGlzRXhwaXJhdGlvbiA9IGZhbHNlKSB7XG4gICAgc3VwZXIuZGVsZXRlKGtleSk7XG5cbiAgICBpZiAoIWlzRXhwaXJhdGlvbikge1xuICAgICAgdGhpcy5oaXRTdGF0aXN0aWNzLmFkZEludmFsaWRhdGVPbmUoKTtcbiAgICB9XG4gICAgdGhpcy5oaXRTdGF0aXN0aWNzLnNldENhY2hlU2l6ZSh0aGlzLnNpemUpO1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgc3VwZXIuY2xlYXIoKTtcblxuICAgIHRoaXMuaGl0U3RhdGlzdGljcy5hZGRJbnZhbGlkYXRlQWxsKCk7XG4gICAgdGhpcy5oaXRTdGF0aXN0aWNzLnNldENhY2hlU2l6ZSh0aGlzLnNpemUpO1xuICB9XG5cbiAgZ2V0KGtleSkge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5pdGVtcywga2V5KSkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXNba2V5XTtcblxuICAgICAgLy8gSXRlbSBoYXMgYWxyZWFkeSBleHBpcmVkXG4gICAgICBpZiAodGhpcy50dGwgPiAwICYmIGl0ZW0uZXhwaXJ5IDw9IERhdGUubm93KCkpIHtcbiAgICAgICAgdGhpcy5kZWxldGUoa2V5LCB0cnVlKTtcbiAgICAgICAgdGhpcy5oaXRTdGF0aXN0aWNzLmFkZEV4cGlyYXRpb24oKTtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIC8vIEl0ZW0gaXMgc3RpbGwgZnJlc2hcbiAgICAgIHRoaXMuYnVtcExydShpdGVtKTtcbiAgICAgIGlmICghaXRlbS52YWx1ZSkge1xuICAgICAgICB0aGlzLmhpdFN0YXRpc3RpY3MuYWRkRmFsc3lIaXQoKTtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVtLnZhbHVlID09PSB1bmRlZmluZWQgfHwgaXRlbS52YWx1ZSA9PT0gbnVsbCB8fCBpdGVtLnZhbHVlID09PSAnJykge1xuICAgICAgICB0aGlzLmhpdFN0YXRpc3RpY3MuYWRkRW1wdHlIaXQoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaGl0U3RhdGlzdGljcy5hZGRIaXQoKTtcbiAgICAgIHJldHVybiBpdGVtLnZhbHVlXG4gICAgfVxuICAgIHRoaXMuaGl0U3RhdGlzdGljcy5hZGRNaXNzKCk7XG4gIH1cbn1jbGFzcyBGaWZvT2JqZWN0IHtcbiAgY29uc3RydWN0b3IobWF4ID0gMTAwMCwgdHRsSW5Nc2VjcyA9IDApIHtcbiAgICBpZiAoaXNOYU4obWF4KSB8fCBtYXggPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgbWF4IHZhbHVlJylcbiAgICB9XG5cbiAgICBpZiAoaXNOYU4odHRsSW5Nc2VjcykgfHwgdHRsSW5Nc2VjcyA8IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0dGwgdmFsdWUnKVxuICAgIH1cblxuICAgIHRoaXMuZmlyc3QgPSBudWxsO1xuICAgIHRoaXMuaXRlbXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMubGFzdCA9IG51bGw7XG4gICAgdGhpcy5zaXplID0gMDtcbiAgICB0aGlzLm1heCA9IG1heDtcbiAgICB0aGlzLnR0bCA9IHR0bEluTXNlY3M7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICB0aGlzLml0ZW1zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLmZpcnN0ID0gbnVsbDtcbiAgICB0aGlzLmxhc3QgPSBudWxsO1xuICAgIHRoaXMuc2l6ZSA9IDA7XG4gIH1cblxuICBkZWxldGUoa2V5KSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLml0ZW1zLCBrZXkpKSB7XG4gICAgICBjb25zdCBkZWxldGVkSXRlbSA9IHRoaXMuaXRlbXNba2V5XTtcblxuICAgICAgZGVsZXRlIHRoaXMuaXRlbXNba2V5XTtcbiAgICAgIHRoaXMuc2l6ZS0tO1xuXG4gICAgICBpZiAoZGVsZXRlZEl0ZW0ucHJldiAhPT0gbnVsbCkge1xuICAgICAgICBkZWxldGVkSXRlbS5wcmV2Lm5leHQgPSBkZWxldGVkSXRlbS5uZXh0O1xuICAgICAgfVxuXG4gICAgICBpZiAoZGVsZXRlZEl0ZW0ubmV4dCAhPT0gbnVsbCkge1xuICAgICAgICBkZWxldGVkSXRlbS5uZXh0LnByZXYgPSBkZWxldGVkSXRlbS5wcmV2O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5maXJzdCA9PT0gZGVsZXRlZEl0ZW0pIHtcbiAgICAgICAgdGhpcy5maXJzdCA9IGRlbGV0ZWRJdGVtLm5leHQ7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmxhc3QgPT09IGRlbGV0ZWRJdGVtKSB7XG4gICAgICAgIHRoaXMubGFzdCA9IGRlbGV0ZWRJdGVtLnByZXY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZGVsZXRlTWFueShrZXlzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmRlbGV0ZShrZXlzW2ldKTtcbiAgICB9XG4gIH1cblxuICBldmljdCgpIHtcbiAgICBpZiAodGhpcy5zaXplID4gMCkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZmlyc3Q7XG5cbiAgICAgIGRlbGV0ZSB0aGlzLml0ZW1zW2l0ZW0ua2V5XTtcblxuICAgICAgaWYgKC0tdGhpcy5zaXplID09PSAwKSB7XG4gICAgICAgIHRoaXMuZmlyc3QgPSBudWxsO1xuICAgICAgICB0aGlzLmxhc3QgPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5maXJzdCA9IGl0ZW0ubmV4dDtcbiAgICAgICAgdGhpcy5maXJzdC5wcmV2ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBleHBpcmVzQXQoa2V5KSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLml0ZW1zLCBrZXkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtc1trZXldLmV4cGlyeVxuICAgIH1cbiAgfVxuXG4gIGdldChrZXkpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuaXRlbXMsIGtleSkpIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLml0ZW1zW2tleV07XG5cbiAgICAgIGlmICh0aGlzLnR0bCA+IDAgJiYgaXRlbS5leHBpcnkgPD0gRGF0ZS5ub3coKSkge1xuICAgICAgICB0aGlzLmRlbGV0ZShrZXkpO1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGl0ZW0udmFsdWVcbiAgICB9XG4gIH1cblxuICBnZXRNYW55KGtleXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0LnB1c2godGhpcy5nZXQoa2V5c1tpXSkpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIGtleXMoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuaXRlbXMpXG4gIH1cblxuICBzZXQoa2V5LCB2YWx1ZSkge1xuICAgIC8vIFJlcGxhY2UgZXhpc3RpbmcgaXRlbVxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5pdGVtcywga2V5KSkge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXNba2V5XTtcbiAgICAgIGl0ZW0udmFsdWUgPSB2YWx1ZTtcblxuICAgICAgaXRlbS5leHBpcnkgPSB0aGlzLnR0bCA+IDAgPyBEYXRlLm5vdygpICsgdGhpcy50dGwgOiB0aGlzLnR0bDtcblxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gQWRkIG5ldyBpdGVtXG4gICAgaWYgKHRoaXMubWF4ID4gMCAmJiB0aGlzLnNpemUgPT09IHRoaXMubWF4KSB7XG4gICAgICB0aGlzLmV2aWN0KCk7XG4gICAgfVxuXG4gICAgY29uc3QgaXRlbSA9IHtcbiAgICAgIGV4cGlyeTogdGhpcy50dGwgPiAwID8gRGF0ZS5ub3coKSArIHRoaXMudHRsIDogdGhpcy50dGwsXG4gICAgICBrZXk6IGtleSxcbiAgICAgIHByZXY6IHRoaXMubGFzdCxcbiAgICAgIG5leHQ6IG51bGwsXG4gICAgICB2YWx1ZSxcbiAgICB9O1xuICAgIHRoaXMuaXRlbXNba2V5XSA9IGl0ZW07XG5cbiAgICBpZiAoKyt0aGlzLnNpemUgPT09IDEpIHtcbiAgICAgIHRoaXMuZmlyc3QgPSBpdGVtO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxhc3QubmV4dCA9IGl0ZW07XG4gICAgfVxuXG4gICAgdGhpcy5sYXN0ID0gaXRlbTtcbiAgfVxufWV4cG9ydHtGaWZvT2JqZWN0IGFzIEZpZm8sRmlmb01hcCxGaWZvT2JqZWN0LEhpdFN0YXRpc3RpY3NSZWNvcmQsTHJ1T2JqZWN0IGFzIExydSxMcnVPYmplY3RIaXRTdGF0aXN0aWNzIGFzIExydUhpdFN0YXRpc3RpY3MsTHJ1TWFwLExydU9iamVjdCxMcnVPYmplY3RIaXRTdGF0aXN0aWNzfTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/toad-cache/dist/toad-cache.mjs\n");

/***/ })

};
;